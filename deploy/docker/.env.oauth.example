# ============================================================================
# Instanton OAuth Configuration Example
# ============================================================================
# Copy this file to .env and fill in your values.
# IMPORTANT: Never commit .env files to version control!
#
# Add to .gitignore:
#   .env
#   *.env
#   .env.*
#   !.env.*.example

# ============================================================================
# Required Configuration
# ============================================================================

# Your tunnel domain (e.g., tunnel.mycompany.com)
INSTANTON_DOMAIN=tunnel.example.com

# OAuth Provider: github, google, or oidc
INSTANTON_OAUTH_PROVIDER=github

# OAuth Client Credentials (from your OAuth provider)
INSTANTON_OAUTH_CLIENT_ID=your-client-id
INSTANTON_OAUTH_CLIENT_SECRET=your-client-secret

# ============================================================================
# Provider-Specific Configuration
# ============================================================================

# For Generic OIDC providers (Okta, Auth0, Keycloak, Azure AD):
# INSTANTON_OAUTH_PROVIDER=oidc
# INSTANTON_OAUTH_ISSUER_URL=https://mycompany.okta.com

# For Google:
# INSTANTON_OAUTH_PROVIDER=google
# (No issuer URL needed - uses OIDC discovery automatically)

# For GitHub:
# INSTANTON_OAUTH_PROVIDER=github
# (No issuer URL needed - uses GitHub OAuth endpoints)

# ============================================================================
# Access Control (Recommended)
# ============================================================================

# Restrict access to specific email domains (comma-separated)
# Only users with emails from these domains can access tunnels
INSTANTON_OAUTH_ALLOWED_DOMAINS=mycompany.com

# Or allow multiple domains:
# INSTANTON_OAUTH_ALLOWED_DOMAINS=mycompany.com,partner.com

# Allow specific email addresses (comma-separated)
# Useful for contractors or external collaborators
# INSTANTON_OAUTH_ALLOWED_EMAILS=contractor@gmail.com,partner@external.com

# If both ALLOWED_DOMAINS and ALLOWED_EMAILS are empty,
# ALL authenticated users will be granted access.

# ============================================================================
# Session Configuration
# ============================================================================

# Session duration in seconds (default: 86400 = 24 hours)
INSTANTON_OAUTH_SESSION_DURATION=86400

# ============================================================================
# Server Configuration
# ============================================================================

# Log level: debug, info, warn, error
INSTANTON_LOG_LEVEL=info

# Request timeout in seconds (0 for indefinite streaming)
INSTANTON_REQUEST_TIMEOUT=120

# Path to TLS certificates directory
INSTANTON_CERTS_PATH=./certs

# ============================================================================
# Monitoring (Optional)
# ============================================================================

# Grafana admin password
GRAFANA_PASSWORD=your-secure-grafana-password

# ============================================================================
# Example Configurations
# ============================================================================

# --- GitHub OAuth ---
# 1. Go to: GitHub > Settings > Developer settings > OAuth Apps > New OAuth App
# 2. Set callback URL: https://tunnel.example.com/_instanton/oauth/callback
# 3. Copy Client ID and generate Client Secret
#
# INSTANTON_OAUTH_PROVIDER=github
# INSTANTON_OAUTH_CLIENT_ID=Iv1.abc123def456
# INSTANTON_OAUTH_CLIENT_SECRET=your-github-secret

# --- Google OAuth ---
# 1. Go to: Google Cloud Console > APIs & Services > Credentials
# 2. Create OAuth 2.0 Client ID (Web application)
# 3. Add redirect URI: https://tunnel.example.com/_instanton/oauth/callback
#
# INSTANTON_OAUTH_PROVIDER=google
# INSTANTON_OAUTH_CLIENT_ID=123456789.apps.googleusercontent.com
# INSTANTON_OAUTH_CLIENT_SECRET=GOCSPX-your-secret

# --- Okta OIDC ---
# 1. Create new Web Application in Okta Admin
# 2. Set sign-in redirect URI: https://tunnel.example.com/_instanton/oauth/callback
# 3. Note your Okta domain
#
# INSTANTON_OAUTH_PROVIDER=oidc
# INSTANTON_OAUTH_ISSUER_URL=https://mycompany.okta.com
# INSTANTON_OAUTH_CLIENT_ID=0oaXXXXXXXXXX
# INSTANTON_OAUTH_CLIENT_SECRET=your-okta-secret

# --- Azure AD OIDC ---
# 1. Register application in Azure Portal > App registrations
# 2. Add redirect URI: https://tunnel.example.com/_instanton/oauth/callback
# 3. Note your tenant ID
#
# INSTANTON_OAUTH_PROVIDER=oidc
# INSTANTON_OAUTH_ISSUER_URL=https://login.microsoftonline.com/YOUR-TENANT-ID/v2.0
# INSTANTON_OAUTH_CLIENT_ID=your-app-client-id
# INSTANTON_OAUTH_CLIENT_SECRET=your-app-client-secret

# --- Auth0 OIDC ---
# 1. Create Regular Web Application in Auth0
# 2. Add callback URL: https://tunnel.example.com/_instanton/oauth/callback
# 3. Note your Auth0 domain
#
# INSTANTON_OAUTH_PROVIDER=oidc
# INSTANTON_OAUTH_ISSUER_URL=https://mycompany.auth0.com
# INSTANTON_OAUTH_CLIENT_ID=your-auth0-client-id
# INSTANTON_OAUTH_CLIENT_SECRET=your-auth0-client-secret

# --- Keycloak OIDC ---
# 1. Create client in your Keycloak realm
# 2. Set Valid Redirect URIs: https://tunnel.example.com/_instanton/oauth/callback
# 3. Note your realm name
#
# INSTANTON_OAUTH_PROVIDER=oidc
# INSTANTON_OAUTH_ISSUER_URL=https://keycloak.mycompany.com/realms/myrealm
# INSTANTON_OAUTH_CLIENT_ID=instanton
# INSTANTON_OAUTH_CLIENT_SECRET=your-keycloak-secret
